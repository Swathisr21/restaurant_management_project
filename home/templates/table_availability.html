{% extends 'base.html' %}

{% block content %}
<h2 style="text-align:center; margin-bottom:20px;">Table Availability</h2>

<!-- Statistics -->
<div style="display:flex; justify-content:center; gap:20px; margin-bottom:30px;">
    <div style="text-align:center; padding:15px; border:1px solid #ddd; border-radius:8px;">
        <h3 style="margin:0; color:#28a745;">{{ available_count }}</h3>
        <p style="margin:5px 0;">Available</p>
    </div>
    <div style="text-align:center; padding:15px; border:1px solid #ddd; border-radius:8px;">
        <h3 style="margin:0; color:#dc3545;">{{ occupied_count }}</h3>
        <p style="margin:5px 0;">Occupied</p>
    </div>
    <div style="text-align:center; padding:15px; border:1px solid #ddd; border-radius:8px;">
        <h3 style="margin:0; color:#007bff;">{{ total_tables }}</h3>
        <p style="margin:5px 0;">Total Tables</p>
    </div>
</div>

<!-- Table Grid -->
<div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:20px; max-width:1000px; margin:0 auto;">

    {% for table in tables %}
    <div style="
        border:2px solid {{ table.is_available|yesno:'#28a745,#dc3545' }};
        border-radius:10px;
        padding:20px;
        text-align:center;
        background: {{ table.is_available|yesno:'#d4edda,#f8d7da' }};
        transition: 0.3s;
    ">

        <h3 style="margin:0 0 10px 0;">Table {{ table.table_number }}</h3>
        <p style="margin:5px 0;"><strong>Capacity:</strong> {{ table.capacity }} people</p>
        <p style="margin:5px 0;">
            <strong>Status:</strong>
            <span style="color:{{ table.is_available|yesno:'#28a745,#dc3545' }}; font-weight:bold;">
                {{ table.is_available|yesno:'Available,Occupied' }}
            </span>
        </p>

        {% if table.is_available %}
            <a href="{% url 'reserve_table' table.id %}" style="
                display:inline-block;
                padding:8px 15px;
                background:#007BFF;
                color:white;
                border-radius:6px;
                text-decoration:none;
                margin-top:10px;
            ">
                Reserve Table
            </a>
        {% else %}
            <span style="color:#dc3545; font-weight:bold;">Occupied</span>
            {% if user.is_staff or user.is_superuser %}
            <br>
            <a href="{% url 'release_table' table.id %}" style="
                display:inline-block;
                padding:6px 12px;
                background:#ffc107;
                color:black;
                border-radius:4px;
                text-decoration:none;
                margin-top:8px;
                font-size:12px;
            ">
                Release (Staff)
            </a>
            {% endif %}
        {% endif %}

    </div>
    {% endfor %}

</div>

<div style="text-align:center; margin-top:30px;">
    <a href="{% url 'home' %}" style="color:#007BFF; text-decoration:none;">‚Üê Back to Home</a>
</div>

{% endblock %}
